var _ = require('lodash');


var JamaInterace = {
    onLayoutChange: function() {
        if (!this.state.roadmap) {
            return;
        }

        this.state.roadmap.layout = layout;

        this.getFlux().actions.RoadmapActions.saveRoadmap({
            id: this.getParams().roadmapId,
            roadmap: this.state.roadmap
        });

        _.each(layout, function(layoutItem) {
            var jamaItem = this.getItemFromId(layoutItem.i);
            jamaItem.fields = _.extend(jamaItem.fields, this.getDatesFromLayout(layoutItem,'$' + jamaItem.itemType));

            this.getFlux().actions.RoadmapActions.updateJamaItem({
                id: layoutItem.i,
                roadmapId: this.getParams().roadmapId,
                item: {
                    fields: jamaItem.fields
                }
            })
        }, this)
    }
}

module.exports = JamaInterace;